# -*- coding: utf-8 -*-
from __future__ import unicode_literals

from django.db import migrations, models
from openquakeplatform.vulnerability.models import FuncDistrVulnDiscr, FDS

def forwards_func(apps, schema_editor):
    db_alias = schema_editor.connection.alias
    func_discrs = FuncDistrVulnDiscr.objects.using(
        db_alias).all()

    for func_discr in func_discrs:
        to_save = False
        if func_discr.func_distr_shape is None:
            func_discr.func_distr_shape = FDS.LOGNORMAL
            to_save = True
        if func_discr.resp_var_val_coeff is None:
            func_discr.resp_var_val_coeff = ";".join(
                "0" * int(func_discr.data_pts_num))
            to_save = True
        if to_save:
            func_discr.save()    
             

def backwards_func(apps, schema_editor):
    pass


class Migration(migrations.Migration):

    dependencies = [
        ('vulnerability', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(forwards_func, backwards_func),
    ]
